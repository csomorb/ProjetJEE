<!DOCTYPE html>
<html lang="fr"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>Album</title>
        <h:outputStylesheet library="css" name="album.css"  />
    </h:head>
    <h:body>
    <h:form >
		<h:commandButton action="#{rechercheController.rech()}" value="Rechercher des photos"/>
		<h:commandButton action="#{albumController.ajout()}" value="Ajouter un album"/>
		<h:commandButton action="#{albumController.listAlbum}" value="Voire tous les albums"/>
		<h:commandButton action="#{appUserSession.logout()}" value="Me dÃ©connecter"/>
	</h:form>   
    <h1>
        <h:outputText value="#{albumController.album.title}"> </h:outputText>
    </h1>
    <p>
    	<h:outputText value="#{albumController.album.description}"> </h:outputText>
    </p>
    
    <c:if test="#{albumController.isMine()}">
    	<h:form>
    	<h:outputLabel for="descr" value="Nouveau description : " />
		<h:inputText id="descr" value="#{albumController.description}" 
			title="Nouvelle description"/>    
    	<h:commandButton action="#{albumController.changerDescription()}" value="Changer la description">
    	   <f:param name="idAlbum" value="#{albumController.album.id}" />
    	</h:commandButton>
        </h:form>
	    <h:form>
		    <h:commandLink action="#{partageController.partagerAlbum()}" value="Partager l'abum">
				<f:param name="idAlbum" value="#{albumController.album.id}" />
			</h:commandLink>
	    </h:form>
    </c:if>
    <ui:repeat var="image" value="#{albumController.listeImage}">
     	<h:graphicImage value="resources/img/#{image.getAlbum().getOwner().getId()}/#{image.getAlbum().getId()}/#{image.getTitle()}" class="minature-album" alt="image"/>
     	<h:form>
    		<h:commandLink action="#{taggingController.tagPhoto}" value="tagger la photo">
				<f:param name="photoId" value="#{image.id}" />
				<f:param name="idAlbum" value="#{albumController.album.id}" />
			</h:commandLink>   |   
			<h:commandLink action="#{albumController.deletePicture(image.id)}" value="supprimer">
				<f:param name="photoId" value="#{image.id}" />
				<f:param name="idAlbum" value="#{albumController.album.id}" />
			</h:commandLink>
			
		</h:form>
    </ui:repeat>
    </h:body>
</html>